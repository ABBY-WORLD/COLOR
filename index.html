<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Oljefärg Simulator (RYB-komplement)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
    }
    #controls {
      margin: 10px auto;
      padding: 10px;
    }
    .color-btn, #clean-brush {
      margin: 5px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
    }
    /* Färgknappar visas som kvadrater utan text */
    .color-btn {
      width: 40px;
      height: 40px;
    }
    /* Röd, Gul, Mörkblå (Ultramarin), Vit */
    .color-btn[data-color="#FF0000"] { background: #FF0000; }
    .color-btn[data-color="#FFFF00"] { background: #FFFF00; }
    .color-btn[data-color="#120A8F"] { background: #120A8F; }
    .color-btn[data-color="#FFFFFF"] {
      background: #FFFFFF;
      border: 1px solid #ccc;
    }
    /* clean brush-knappen */
    #clean-brush {
      background: #333;
      color: #fff;
      padding: 10px 15px;
      font-size: 16px;
    }
    /* Mörkare bakgrundsfärg på canvasen */
    #canvas {
      border: 1px solid #ccc;
      background: #888888;
      cursor: crosshair;
      display: block;
      margin: 0 auto 20px auto;
    }
  </style>
</head>
<body>
  <div id="controls">
    <button class="color-btn" data-color="#FF0000"></button>
    <button class="color-btn" data-color="#FFFF00"></button>
    <button class="color-btn" data-color="#120A8F"></button>
    <button class="color-btn" data-color="#FFFFFF"></button>
    <button id="clean-brush">clean brush</button>
  </div>

  <canvas id="canvas" width="800" height="600"></canvas>

  <!-- Inkludera chroma.js för färgkonverteringar -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.0/chroma.min.js"></script>
  <script>
    /************************************************************
     * 1) Grundinställningar
     ************************************************************/
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    // Bakgrund
    const backgroundColor = "#888888";
    ctx.fillStyle = backgroundColor;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Pensel-egenskaper
    let selectedColor = "#FF0000";  // Förvald färg
    let brushColor = selectedColor; // Penselns aktuella färg
    const brushRadius = 20;         // Radie på penseln
    let isDrawing = false;          // Om vi håller nere musknappen
    const brushPickup = 0.3;        // Hur mycket penseln plockar upp av färgen den målar över
    const maxWeight = 0.8;          // Hur mycket penselfärg som max blandas i mitten av penseln

    /************************************************************
     * 2) Hjälpfunktioner för att klassificera färg i RYB-hjulet
     ************************************************************/
    /**
     * getRybCategory(hue)
     * Tar en HSL-hue (0..360) och approximerar den till en av
     * sex huvudkategorier: red, orange, yellow, green, blue, purple
     * (enligt RYB-liknande positioner).
     */
    function getRybCategory(hue) {
      // Närmaste mittpunkter i hue för RYB:
      // red=0°, orange=30°, yellow
