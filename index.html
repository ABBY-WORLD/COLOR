<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Realistic RYB Paint Mixer</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; cursor: crosshair; }
    </style>
</head>
<body>
<canvas id="paintCanvas"></canvas>
<script>
const canvas = document.getElementById('paintCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const colors = {
    red: [255, 0, 0],
    yellow: [255, 255, 0],
    blue: [0, 0, 255],
    white: [255, 255, 255]
};

let currentMix = [];
let painting = false;

const piles = [
    { x: 50, y: 50, color: 'red' },
    { x: 150, y: 50, color: 'yellow' },
    { x: 250, y: 50, color: 'blue' },
    { x: 350, y: 50, color: 'white' }
];

function drawPiles() {
    piles.forEach(pile => {
        ctx.fillStyle = `rgb(${colors[pile.color].join(',')})`;
        ctx.beginPath();
        ctx.arc(pile.x, pile.y, 30, 0, Math.PI * 2);
        ctx.fill();
    });
}

drawPiles();

canvas.addEventListener('mousedown', e => {
    piles.forEach(pile => {
        const dx = e.clientX - pile.x;
        const dy = e.clientY - pile.y;
        if (dx * dx + dy * dy <= 30 * 30) {
            currentMix.push(colors[pile.color]);
        }
    });
    painting = true;
});

canvas.addEventListener('mouseup', () => {
    painting = false;
});

canvas.addEventListener('mousemove', e => {
    if (!painting || currentMix.length === 0) return;

    const pixel = ctx.getImageData(e.clientX, e.clientY, 1, 1).data;
    let existingRGB = [pixel[0], pixel[1], pixel[2]];

    let mixedColor = getMixedColor(existingRGB, currentMix);

    ctx.fillStyle = `rgba(${mixedColor.join(',')},0.8)`;
    ctx.beginPath();
    ctx.arc(e.clientX, e.clientY, 30, 0, Math.PI * 2);
    ctx.fill();
});

function getMixedColor(baseColor, mixArray) {
    let totalWeight = mixArray.length + 1;
    let blended = [
        (baseColor[0] + mixArray.reduce((sum, color) => sum + color[0], 0)) / totalWeight,
        (baseColor[1] + mixArray.reduce((sum, color) => sum + color[1], 0)) / totalWeight,
        (baseColor[2] + mixArray.reduce((sum, color) => sum + color[2], 0)) / totalWeight
    ];

    let blueAmount = mixArray.filter(c => c[2] > c[0] && c[2] > c[1]).length;
    let warmAmount = mixArray.filter(c => c[0] > c[2] || c[1] > c[2]).length;
    let brightnessAdjustment = warmAmount * 10 - blueAmount * 15;

    blended = blended.map(v => Math.max(0, Math.min(255, v + brightnessAdjustment)));
    return blended.map(v => Math.floor(v));
}

window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    ctx.fillStyle = "rgb(90,90,90)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    drawPiles();
});

ctx.fillStyle = "rgb(90,90,90)";
ctx.fillRect(0, 0, canvas.width, canvas.height);
drawPiles();
</script>
</body>
</html>
